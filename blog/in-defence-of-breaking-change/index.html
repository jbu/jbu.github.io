<!doctype html><html lang=en-us><head><title>In Defence of Breaking Change | James Uther</title><meta charset=utf-8><meta name=language content="en"><meta name=description content><meta name=keywords content><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=twitter:card content="summary"><meta name=twitter:title content="In Defence of Breaking Change"><meta name=twitter:description content><meta name=twitter:site content="https://twitter.com/hemul"><meta name=twitter:creator content="https://twitter.com/hemul"><link rel="shortcut icon" type=image/png href=https://uther.wtf/favicon.ico><link type=text/css rel=stylesheet href=https://uther.wtf/css/post.min.86d1effd4c412b85ac13db53a90c473a0f256f789b821e131125c9aa25cb6a6d.css integrity="sha256-htHv/UxBK4WsE9tTqQxHOg8lb3ibgh4TESXJqiXLam0="><link type=text/css rel=stylesheet href=https://uther.wtf/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/uther.wtf"},"articleSection":"blog","name":"In Defence of Breaking Change","headline":"In Defence of Breaking Change","description":"","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2020","datePublished":"2020-10-02 00:00:00 \u002b0000 UTC","dateModified":"2020-10-02 00:00:00 \u002b0000 UTC","url":"https:\/\/uther.wtf\/blog\/in-defence-of-breaking-change\/","wordCount":"778","keywords":["Blog"]}</script></head><body><div class=burger__container><div class=burger aria-controls=navigation aria-label=Menu><div class="burger__meat burger__meat--1"></div><div class="burger__meat burger__meat--2"></div><div class="burger__meat burger__meat--3"></div></div></div><nav class=nav id=navigation><ul class=nav__list><li><a href=https://uther.wtf/>Home</a></li><li><a href=https://uther.wtf/cv>Curriculum vitae</a></li><li><a class=active href=https://uther.wtf/blog>blog</a></li></ul></nav><main><div class=flex-wrapper><div class=post__container><div class=post><header class=post__header><h1 id=post__title>In Defence of Breaking Change</h1><time datetime="2020-10-02 00:00:00 +0000 UTC" class=post__date>2020-10-02</time></header><article class=post__content><blockquote><p>Is nuance absolutely awesome, or simply rubbish? -<em>The news quiz, 103:2</em></p></blockquote><p>For the purposes of this post let’s assume it’s simply rubbish.</p><p>Received wisdom is that breaking changes to supporting software (OS, libraries, services, etc) is bad. This makes intuitive sense. An API is a contract, and contracts are to be honoured.</p><p>We have <a href=https://semver.org/ target=_blank rel="noreferrer noopener">SemVer</a> to attempt to manage changes. Rich Hickey thinks that SemVer is wrong, and you should <a href="https://www.youtube.com/watch?v=oyLBGkS5ICk" target=_blank rel="noreferrer noopener">just accrete</a>. Platform providers go to great lengths to let you keep running your broken software. Here’s some Microsoft <a href=http://ptgmedia.pearsoncmg.com/images/9780321440303/samplechapter/Chen_bonus_ch01.pdf target=_blank rel="noreferrer noopener">war stories</a>. And of course, Linus has <a href=https://lkml.org/lkml/2012/12/23/75 target=_blank rel="noreferrer noopener">an opinion</a> (and is working on expressing his opinions in a more constructive way).</p><p>But there’s a hold out. Recently Steve Yegge had a <a href=https://medium.com/@steve.yegge/dear-google-cloud-your-deprecation-policy-is-killing-you-ee7525dc05dc target=_blank rel="noreferrer noopener">rant</a> about how google keeps ignoring this sensible consensus. And we all know that’s true. Just try saying ‘google reader’ to a bunch of engineers and feel the wave of unresolved loss, and that’s for a free service, not a paid and supported API. But why does Google do that? Now, the first law of software engineering is “You are not Google”. You do not have a magic money machine in the basement and a good percentage of engineering talent working for you (If you do, DM me). It turns out that internally they use that money and talent to do things the hard, right way (sometimes).</p><p><em>“God is change”</em> says the prophet in <em>“Parable of the Sower”</em>[1]. Google faced the fact that things change, and that <em>“Software Engineering is Programming integrated over time”</em>. Getting a program to run once is programming. Getting it to keep running when the OS gets upgraded, the team changes, requirements change, dependencies are upgraded, laws change, businesses change, […] is engineering. For good software to remain good software into the future the code must be malleable and deployable.</p><p>Let’s narrow this to managing dependencies. Managing versioning between modules is a problem that scales quadratically, and is worse than you think given <a href=https://www.hyrumslaw.com/ target=_blank rel="noreferrer noopener">Hyrum’s law</a> that in the limit there is no such thing as a private interface. In the Google case, it’s their code and they can tackle the problem at the root. Their solution seems to be ‘live at head’. It ideally goes something like this:</p><ul><li>everything is comprehensively covered by automated testing</li><li>a module is published (and it’s all public interface, see Hyrum’s Law)</li><li>it becomes widely used</li><li>a new version is published. It breaks a test somewhere.</li><li>a decision is made whether to fix the module, or fix the consumer</li><li>if many consumers will break, and they all need to be fixed, a tool is shipped to automate the fix
given it’s all in an obsessively tested monorepo the change is shipped when ‘google works with this change’</li><li>the tail of supported versions is therefore very short, if it exists at all</li><li>A relatively recent presentation “Live at Head“: gives a far more authoritative view.</li></ul><p>In essence, the contract changes from <em>“We will not break the contract”</em> to <em>“We might break the contract but will provide good tools/docs (perhaps API credits?) to assist migration.”</em></p><p>Now the point of the Yegge rant above is that Google is <strong>not</strong> doing this reliably in the public APIs. It’s hard! But let’s assume the utopia. What would a software project that uses these ‘live at head’ APIs look like? There seem to be a few things that are necessary:</p><ul><li>the engineering is live, as in there is institutional memory about how to make changes and get them into production</li><li>the code is well provisioned with automated tests</li><li>there is a live CI system that speculatively upgrades dependencies</li><li>if a test breaks because of a dependency upgrade there is someone who can step in to investigate</li><li>the step above is much simpler if the code is regular enough to allow automated upgrade tools to work. Newer languages like ‘Go’ are designed with this in mind</li></ul><p>This is not a big investment, and well worth it. But it is a change of mindset. A software project from an enterprise would not just hand over a binary. They wouldn’t even just hand over a service and a monthly AWS bill. The project would involve setting up and leaving behind (or maintaining – for a reasonable consideration) the engineering capability listed above. In return, the customer would have software that has all the latest security patches, performance improvements, and so forth, and whoever is running the service would have the capability to optimise runtime platforms etc. That’s a win/win from where I’m standing.</p><p>(1) <a href=https://www.newyorker.com/books/second-read/octavia-butlers-prescient-vision-of-a-zealot-elected-to-make-america-great-again target=_blank rel="noreferrer noopener">“In the ongoing contest over which dystopian classic is most applicable to our time […] Butler’s novel […] may be unmatched.”</a></p><p>(Originally in <a href=http://web.archive.org/web/20201113035100/https://tech.labs.oliverwyman.com/blog/2020/10/02/breaking-changes/ target=_blank rel="noreferrer noopener">http://web.archive.org/web/20201113035100/https://tech.labs.oliverwyman.com/blog/2020/10/02/breaking-changes/</a>)</p></article><div class=pagination><a class=pagination__item href=https://uther.wtf/blog/nfrs-considered-harmful/><span class=pagination__label>Previous Post</span>
<span class=pagination__title>Nfrs Considered Harmful</span></a>
<a class=pagination__item href=https://uther.wtf/blog/three-issues-tech-debt/><span class=pagination__label>Next Post</span>
<span class=pagination__title>Three Issues that sum up Technical Debt</span></a></div><footer class=post__footer><div class=social-icons><a class=social-icons__link title=Twitter href=https://twitter.com/hemul target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/twitter.svg)></div></a><a class=social-icons__link title=GitHub href=https://github.com/jbu target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/github.svg)></div></a><a class=social-icons__link title=LinkedIn href=https://www.linkedin.com/in/jamesuther/ target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/linkedin.svg)></div></a></div><p>© 2022</p></footer></div></div></div></main><script src=https://uther.wtf/js/index.min.301a8b0870381bf76b3b5182e8966d363a0474281183439beb024d8b8228fc66.js integrity="sha256-MBqLCHA4G/drO1GC6JZtNjoEdCgRg0Ob6wJNi4Io/GY=" crossorigin=anonymous></script>
<script src=https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js></script>
<script src=https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js data-autoloader-path=https://unpkg.com/prismjs@1.20.0/components/></script></body></html>