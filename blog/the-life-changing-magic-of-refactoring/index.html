<!doctype html><html lang=en-us><head><title>The Life Changing Magic of Refactoring | Dr James Uther</title><meta charset=utf-8><meta name=language content="en"><meta name=description content><meta name=keywords content><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=twitter:card content="summary"><meta name=twitter:title content="The Life Changing Magic of Refactoring"><meta name=twitter:description content><meta name=twitter:site content="https://twitter.com/hemul"><meta name=twitter:creator content="https://twitter.com/hemul"><link rel="shortcut icon" type=image/png href=/favicon.ico><link type=text/css rel=stylesheet href=/css/post.min.86d1effd4c412b85ac13db53a90c473a0f256f789b821e131125c9aa25cb6a6d.css integrity="sha256-htHv/UxBK4WsE9tTqQxHOg8lb3ibgh4TESXJqiXLam0="><link type=text/css rel=stylesheet href=/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/uther.wtf"},"articleSection":"blog","name":"The Life Changing Magic of Refactoring","headline":"The Life Changing Magic of Refactoring","description":"","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2015","datePublished":"2015-10-30 00:00:00 \u002b0000 UTC","dateModified":"2015-10-30 00:00:00 \u002b0000 UTC","url":"https:\/\/uther.wtf\/blog\/the-life-changing-magic-of-refactoring\/","wordCount":"1020","keywords":["Blog"]}</script></head><body><div class=burger__container><div class=burger aria-controls=navigation aria-label=Menu><div class="burger__meat burger__meat--1"></div><div class="burger__meat burger__meat--2"></div><div class="burger__meat burger__meat--3"></div></div></div><nav class=nav id=navigation><ul class=nav__list><li><a href=/>about</a></li><li><a class=active href=/blog>blog</a></li><li><a href=/cv>CV</a></li></ul></nav><main><div class=flex-wrapper><div class=post__container><div class=post><header class=post__header><h1 id=post__title>The Life Changing Magic of Refactoring</h1><time datetime="2015-10-30 00:00:00 +0000 UTC" class=post__date>2015-10-30</time></header><article class=post__content><p>I’m really a unix guy, but I have to admit, the whole .NET/SQLserver stack is hugely empowering. An average employee can take it, and with next to no knowledge or experience, but with a lot of determination and time, can write enough code to underpin an entire company. You start with a windows form, place a control, it generates an event handler for you, you stick in a bit of sql, and off you go, and it works! (for a sufficiently broad understanding of ‘works’). And the creator becomes the company hero because whenever something blows up or catches fire, you can go to them and they can make things work again!</p><p>The code becomes a broad expanse of event handlers randomly wired together. You and I might have a few laugh out loud moments when examining it, and trying to actually understand it is a trip into the dark nightmares of a tormented soul. Reliving the time they discovered database triggers, or misunderstood a blog post about a design pattern.</p><p><strong>This sort of code runs the world.</strong></p><p>Anyway, just say the one person team who developed the whole shebang is no longer available, and you’re called in to help keep things going or even make it better. You have a choice, you can rewrite or refactor. Now your instinct is to drive a stake through the dark heart of the abomination, burn it with fire, and write a clean new system in Haskell (or perhaps Rust, given the chatter around the office today).
I completely understand, but just hold on for a moment! If you rewrite, then you’re committing to supporting the current version (which is prone to conflagration), while at the same time transferring every undocumented feature and assumption into the new system, and then seamlessly migrating data, and operations teams, across, which is more tricky than you think. At the same time, whenever there is a lean time it’s the new hotness that’s for the chopper, because the old and busted is what’s actually running the company. So chances are you’re never going to get to finish your new hotness, and you’re stuck supporting the old and busted indefinitely. Welcome to a special circle of hell. [1]
The harder but less risky option is to face the old and busted, like Hercules faced the Aegean Stables, and start cleaning. But how? Where to start? There are many books on refactoring and removing technical debt. And my new favourite is ‘The Life-Changing Magic of Tidying: A simple, effective way to banish clutter forever’ by <a href=https://konmari.com target=_blank rel="noreferrer noopener">Marie Kondo</a></p><p>For those of you who missed the pop culture storm this book created when published a year or so ago, it’s a how-to for tidying your home. But more than that, the ‘Konmari’ method can become a lifestyle change, and to some facebook groups, a religion. Flame wars about how to arrange socks! Who knew? Anyway, I quite like the konmari method, and I’ve started to look at how it can be used to clean even the most cluttered home^h^h^h^h codebase, identifying transformations that can be applied to turn mess into something manageable.
For those of you who haven’t been exposed, the Konmari method may be summarised as:</p><ul><li>Pick a category (clothes, books, dvds, kitchen things, paperwork, etc). She has a preferred order to work in.</li><li>Get <strong>everything</strong> in that category into one place, where you can see it (search the garage, loft, basement, parent’s house, etc and make sure you get it <strong>all</strong>).</li><li>Find the things that ‘spark joy’, and <strong>throw the rest away</strong>. Or give, recycle, whatever. Just get it out of your life.</li><li>Put the remainder in a deliberately chosen place, in such a way that you can see them (so they get used!). She has suggestions for this.</li><li>Keep it up (but it’s easy once you do the first big clean)</li><li>Enjoy your new life where you are in control of your stuff!</li></ul><p>I propose that this applies to code. I’ve long held that the best broad metric for technical debt is lines of code, and aggressively getting rid of code is often the most productive thing you can do. That said, you have no idea what you can get rid of until you can get an overview of everything that relates. So, here are some early thoughts of ‘categories’ in code, and how ‘getting everything into one place’ might look.</p><p>A <strong>database table</strong> might be a category. Getting it all into one place would mean reducing any related stored procedures, sql functions or triggers to minimum and transferring the logic to your client language where it can be refactored as a whole. You might find that you need to introduce some sort of wrapper that contains the common code found among all the various interactions with the table, which is a win. You may also find that huge swathes of the code are just not used. Get rid of it!</p><p><strong>UI</strong>: Log every time a form opens (yay the ELK stack!). If after a month or so you find that there are forms that are not used, you know what to do!</p><p><strong>Integrations</strong>: Sometimes links to other systems are not over a well defined bridge, but through random API calls thorough your system. Build a bridge. Centralise the integration. Refactor <em>all</em> the code to use the bridge. This might allow you to, say, use a queue in the bridge to solve a performance problem, or do something helpful with a network where you couldn’t before.</p><p><strong>Business crown jewels</strong>: Is there a process, reporting system, large calculation, that is business critical but not in a well specified and defined location in the code? Make it so! Capture it in a well designed module (and keep it safe).</p><p>Often each of these can be set up as a project that delivers something concrete and useful to the customer, even if it’s reduced risk or support costs. That makes it far easier to justify and support. You get to move from win to win until (eventually) you end up with the new hotness, just by a different path.</p><p><a href=http://memegenerator.net/instance/62502463 target=_blank rel="noreferrer noopener"><img src=https://memegenerator.net/img/instances/62502463.jpg alt="Konmari all the things!"></a></p><p>(Originally <a href=http://web.archive.org/web/20161006162129/http://www.lshift.net/blog/2015/10/30/the-life-changing-magic-of-refactoring/ target=_blank rel="noreferrer noopener">http://web.archive.org/web/20161006162129/http://www.lshift.net/blog/2015/10/30/the-life-changing-magic-of-refactoring/</a>)</p></article><div class=pagination><a class=pagination__item href=https://uther.wtf/blog/ga4gh/><span class=pagination__label>Previous Post</span>
<span class=pagination__title>Ga4gh</span></a>
<a class=pagination__item href=https://uther.wtf/blog/application-patterns-for-the-outernet/><span class=pagination__label>Next Post</span>
<span class=pagination__title>Application Patterns for the Outernet</span></a></div><footer class=post__footer><div class=social-icons><a class=social-icons__link title=Twitter href=https://twitter.com/hemul target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/twitter.svg)></div></a><a class=social-icons__link title=GitHub href=https://github.com/jbu target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/github.svg)></div></a><a class=social-icons__link title=Email href=mailto:j@uther.wtf target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/email.svg)></div></a><a class=social-icons__link title=LinkedIn href=https://www.linkedin.com/in/jamesuther/ target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/linkedin.svg)></div></a></div><p>© 2022</p></footer></div></div></div></main><script src=/js/index.min.301a8b0870381bf76b3b5182e8966d363a0474281183439beb024d8b8228fc66.js integrity="sha256-MBqLCHA4G/drO1GC6JZtNjoEdCgRg0Ob6wJNi4Io/GY=" crossorigin=anonymous></script>
<script src=https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js></script>
<script src=https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js data-autoloader-path=https://unpkg.com/prismjs@1.20.0/components/></script></body></html>