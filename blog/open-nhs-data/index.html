<!doctype html><html lang=en-us><head><title>Playing with open NHS data, and a rant | James Uther</title><meta charset=utf-8><meta name=language content="en"><meta name=description content><meta name=keywords content><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=twitter:card content="summary"><meta name=twitter:title content="Playing with open NHS data, and a rant"><meta name=twitter:description content><meta name=twitter:site content="https://twitter.com/hemul"><meta name=twitter:creator content="https://twitter.com/hemul"><link rel="shortcut icon" type=image/png href=https://uther.wtf/favicon.ico><link type=text/css rel=stylesheet href=https://uther.wtf/css/post.min.86d1effd4c412b85ac13db53a90c473a0f256f789b821e131125c9aa25cb6a6d.css integrity="sha256-htHv/UxBK4WsE9tTqQxHOg8lb3ibgh4TESXJqiXLam0="><link type=text/css rel=stylesheet href=https://uther.wtf/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/uther.wtf"},"articleSection":"blog","name":"Playing with open NHS data, and a rant","headline":"Playing with open NHS data, and a rant","description":"","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2014","datePublished":"2014-12-24 00:00:00 \u002b0000 UTC","dateModified":"2014-12-24 00:00:00 \u002b0000 UTC","url":"https:\/\/uther.wtf\/blog\/open-nhs-data\/","wordCount":"869","keywords":["Blog"]}</script></head><body><div class=burger__container><div class=burger aria-controls=navigation aria-label=Menu><div class="burger__meat burger__meat--1"></div><div class="burger__meat burger__meat--2"></div><div class="burger__meat burger__meat--3"></div></div></div><nav class=nav id=navigation><ul class=nav__list><li><a href=https://uther.wtf/>Home</a></li><li><a href=https://uther.wtf/cv>Curriculum vitae</a></li><li><a class=active href=https://uther.wtf/blog>blog</a></li></ul></nav><main><div class=flex-wrapper><div class=post__container><div class=post><header class=post__header><h1 id=post__title>Playing with open NHS data, and a rant</h1><time datetime="2014-12-24 00:00:00 +0000 UTC" class=post__date>2014-12-24</time></header><article class=post__content><p>Open Data™ is being pushed quite heavily by the powers that be, which is mostly a good thing because It’s useful information that I want to use, and I’ve already paid taxes for it. Also, this is a democracy dammit. Can Haz Sunlight!. The NHS is part of this. For most of this post we will look at the published sets of prescription data, but see <rant>below. And we’re going to look at how to use some open information about U.K. postcodes to homogenise the data across a big reorganisation of the NHS.</p><p><a href=http://www.hscic.gov.uk/gpprescribingdata target=_blank rel="noreferrer noopener">The data</a>, published monthly, is a list what drugs each GP practice has prescribed that month. So when you are prescribed your Penicillin by your GP, that goes into the list that says, at the end of the month, your GPs practice prescribed 57 courses of Foo-brand penicillin capsules at a cost to the NHS of £120 (or whatever).</p><ul><li>Each practice has a Practice ID. An ancillary .csv file published with the main data links each practice ID that is contained in the month’s data to a practice name and address including postcode. The IDs seem to be pretty stable across name changes and small office moves.</li><li>The medicines are coded according the <a href=http://www.bnf.org/bnf/index.htm target=_blank rel="noreferrer noopener">British National Formulary</a> (BNF). The codes in these files are at the ‘presentation’ level, which is the most specific. So if we wanted to find out about just ‘penicillin’ we roll up all the different brands and packagings of penicillin to the ‘chemical’ level of the BNF.</li><li>Each practice is also part of a regional grouping. Before about April 2013, this was the ‘Primary Care Trust’ (PCT). Now it’s the <a href=http://www.england.nhs.uk/resources/ccg-directory/%e2%80%98 target=_blank rel="noreferrer noopener">‘Clinical Commissioning Group (CCG)</a>.</li></ul><p>So, let’s say you want to look at how much penicillin was prescribed in CCG Ealing as far back as we have data. How do we convert those old PCT groupings into CCGs?</p><p>Getting most of the way there is not so hard. Start with the data we have that uses CCGs, and for each practice ID we have with a CCG, use that in the old PCT data. But there are practices that don’t appear in the new data (they might have been closed before then for instance). Now things get a bit more tricky, and we have to start playing around.</p><p>It might be tempting to find a map of the <a href=http://www.england.nhs.uk/resources/ccg-maps/ target=_blank rel="noreferrer noopener">CCG boundaries</a>, use some geolocation service to find a latitude and longitude of all practices (over a period of a few days because we don’t want to pay for a commercial API key), and convert accordingly. But that’s harder than necessary. What sort of idiot would do that? he asks rhetorically, particularly when it turns out that the Office of National Statistics publishes, among a whole pile of other handy things, a little data set called the <a href=http://www.ons.gov.uk/ons/guide-method/geography/products/postcode-directories/-nspp-/index.html target=_blank rel="noreferrer noopener">ONS Postcode Directory</a> that links all these things together. It’s actually a list of all the sub-regions used by the ONS, mapped to their postcode and bunch of other administrative regions, which happen to include, if you find the right file, both the current CCG and the old PCT. And a practice has a postcode, so we now have a postcode/CCG/PCT mapping. yay!</p><p>It doesn’t get us all the way there, because postcodes seem to change more regularly than you’d think, and the post office is the canonical owner of postcodes, not the ONS, and some organisations (like CCGs and PCTs) have weird off-map postcodes. But we’ve achieved a good balance between 100% and done.</p><rant><p>We’re straying into uncharted social waters with some of this data, and we really don’t know what we’re doing. This particular dataset is probably ok, in that it’s to do with the finances of a public body on the one hand (transparency) but doesn’t betray the confidences of that same public. Unless of course you’re the only person at a GP that takes a rare prescription, and people can guess that from your address and some public knowledge about your health.</p><p>As for how this data set is collected, I really don’t know. It’s drawn from the whole prescription payment system which is labyrinthine. I’ve no idea if there is a point in the chain where my entire prescription history is stored. If so, I’ve no idea how it’s stored, or whether it might be <a href=hhttps://www.mysociety.org/2014/12/20/another-private-data-leak-this-time-by-hackney-council/>accidentally released in an FOI request</a>, or how likely a Sony Pictures-like scenario is. And this is the underbelly of centralisation of data. Yes, you can do big-data analysis of whatever which might help with medical research or spotting public health trends. But it’s easier to compromise a single system than all the massively heterogenous GP systems. Apparently the ONS has this in hand, so things like census data are well cared for. They tend towards the ‘Tower of London’ approach of keeping all the eggs in one basket and then guarding the basket well. Other researchers can still use the data, but there’s an ethics system in place to vet the analyses and use.</p><p>But more than this, <a href=http://theodi.org/lunchtime-lectures/friday-lunchtime-lecture-why-selling-peoples-medicaltaxschool-records-isnt-open-data target=_blank rel="noreferrer noopener">apparently</a> some are still thinking that identifiable medical records might be a revenue stream. Sort of the NHS taking on the Facebook business model. Let’s not do that.</p><p>(Originally <a href=http://web.archive.org/web/20160319092856/http://www.lshift.net/blog/2014/12/24/playing-with-open-nhs-data-and-a-rant/ target=_blank rel="noreferrer noopener">http://web.archive.org/web/20160319092856/http://www.lshift.net/blog/2014/12/24/playing-with-open-nhs-data-and-a-rant/</a>)</p></article><div class=pagination><a class=pagination__item href=https://uther.wtf/blog/codemesh-day-1/><span class=pagination__label>Previous Post</span>
<span class=pagination__title>Codemesh Day 1</span></a>
<a class=pagination__item href=https://uther.wtf/blog/lets-run-science-part-iota/><span class=pagination__label>Next Post</span>
<span class=pagination__title>Lets Run Science Part Iota</span></a></div><footer class=post__footer><div class=social-icons><a class=social-icons__link title=Twitter href=https://twitter.com/hemul target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/twitter.svg)></div></a><a class=social-icons__link title=GitHub href=https://github.com/jbu target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/github.svg)></div></a><a class=social-icons__link title=LinkedIn href=https://www.linkedin.com/in/jamesuther/ target=_blank rel="me noopener"><div class=social-icons__icon style=background-image:url(https://uther.wtf/svg/linkedin.svg)></div></a></div><p>© 2022</p></footer></div></div></div></main><script src=https://uther.wtf/js/index.min.301a8b0870381bf76b3b5182e8966d363a0474281183439beb024d8b8228fc66.js integrity="sha256-MBqLCHA4G/drO1GC6JZtNjoEdCgRg0Ob6wJNi4Io/GY=" crossorigin=anonymous></script>
<script src=https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js></script>
<script src=https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js data-autoloader-path=https://unpkg.com/prismjs@1.20.0/components/></script></body></html>