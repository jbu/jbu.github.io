<!doctype html><html lang=en-us><head><title>James Uther - Playing with open NHS data, and a rant</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=description content="Open Data™ is being pushed quite heavily by the powers that be, which is mostly a good thing because It’s useful information that I want to use, and I’ve already paid taxes for it. Also, this is a democracy dammit. Can Haz Sunlight!. The NHS is part of this. For most of this post we will look at the published sets of prescription data, but see  below. And we’re going to look at how to use some open information about U. "><link rel=canonical href=https://uther.wtf/blog/open-nhs-data/><link rel=icon type=image/x-icon href=https://uther.wtf/favicon/favicon.ico><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.css><link rel=stylesheet href=https://unpkg.com/purecss@2.0.6/build/pure-min.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.css><link rel=stylesheet href=https://uther.wtf/css/hugo-tufte.min.css><link rel=stylesheet href=https://uther.wtf/css/hugo-tufte-override.css></head><body><div id=layout class=pure-g><article class=pure-u-1><header class=brand><a href=https://uther.wtf><h1>James Uther</h1></a><h2>Musings mostly on software engineering.</h2><nav class=menu><ul><li><a href=https://uther.wtf/><i class="fas fa-home la-lg"></i>Home</a></li><li><a href=https://uther.wtf/blog><i class="fas fa-book fa-lg"></i> blog</a></li><li><a href=https://uther.wtf/cv><i class="fas fa-info-circle fa-lg"></i> Curriculum vitae</a></li></ul></nav><hr></header><section><h1 class=content-title><a href=https://uther.wtf/blog/open-nhs-data/>Playing with open NHS data, and a rant</a></h1></section><section><p>Open Data™ is being pushed quite heavily by the powers that be, which is mostly a good thing because It’s useful information that I want to use, and I’ve already paid taxes for it. Also, this is a democracy dammit. Can Haz Sunlight!. The NHS is part of this. For most of this post we will look at the published sets of prescription data, but see <rant>below. And we’re going to look at how to use some open information about U.K. postcodes to homogenise the data across a big reorganisation of the NHS.</p><p><a href=http://www.hscic.gov.uk/gpprescribingdata>The data</a>, published monthly, is a list what drugs each GP practice has prescribed that month. So when you are prescribed your Penicillin by your GP, that goes into the list that says, at the end of the month, your GPs practice prescribed 57 courses of Foo-brand penicillin capsules at a cost to the NHS of £120 (or whatever).</p><ul><li>Each practice has a Practice ID. An ancillary .csv file published with the main data links each practice ID that is contained in the month’s data to a practice name and address including postcode. The IDs seem to be pretty stable across name changes and small office moves.</li><li>The medicines are coded according the <a href=http://www.bnf.org/bnf/index.htm>British National Formulary</a> (BNF). The codes in these files are at the ‘presentation’ level, which is the most specific. So if we wanted to find out about just ‘penicillin’ we roll up all the different brands and packagings of penicillin to the ‘chemical’ level of the BNF.</li><li>Each practice is also part of a regional grouping. Before about April 2013, this was the ‘Primary Care Trust’ (PCT). Now it’s the <a href=http://www.england.nhs.uk/resources/ccg-directory/%E2%80%98>‘Clinical Commissioning Group (CCG)</a>.</li></ul><p>So, let’s say you want to look at how much penicillin was prescribed in CCG Ealing as far back as we have data. How do we convert those old PCT groupings into CCGs?</p><p>Getting most of the way there is not so hard. Start with the data we have that uses CCGs, and for each practice ID we have with a CCG, use that in the old PCT data. But there are practices that don’t appear in the new data (they might have been closed before then for instance). Now things get a bit more tricky, and we have to start playing around.</p><p>It might be tempting to find a map of the <a href=http://www.england.nhs.uk/resources/ccg-maps/>CCG boundaries</a>, use some geolocation service to find a latitude and longitude of all practices (over a period of a few days because we don’t want to pay for a commercial API key), and convert accordingly. But that’s harder than necessary. What sort of idiot would do that? he asks rhetorically, particularly when it turns out that the Office of National Statistics publishes, among a whole pile of other handy things, a little data set called the <a href=http://www.ons.gov.uk/ons/guide-method/geography/products/postcode-directories/-nspp-/index.html>ONS Postcode Directory</a> that links all these things together. It’s actually a list of all the sub-regions used by the ONS, mapped to their postcode and bunch of other administrative regions, which happen to include, if you find the right file, both the current CCG and the old PCT. And a practice has a postcode, so we now have a postcode/CCG/PCT mapping. yay!</p><p>It doesn’t get us all the way there, because postcodes seem to change more regularly than you’d think, and the post office is the canonical owner of postcodes, not the ONS, and some organisations (like CCGs and PCTs) have weird off-map postcodes. But we’ve achieved a good balance between 100% and done.</p><rant><p>We’re straying into uncharted social waters with some of this data, and we really don’t know what we’re doing. This particular dataset is probably ok, in that it’s to do with the finances of a public body on the one hand (transparency) but doesn’t betray the confidences of that same public. Unless of course you’re the only person at a GP that takes a rare prescription, and people can guess that from your address and some public knowledge about your health.</p><p>As for how this data set is collected, I really don’t know. It’s drawn from the whole prescription payment system which is labyrinthine. I’ve no idea if there is a point in the chain where my entire prescription history is stored. If so, I’ve no idea how it’s stored, or whether it might be <a href=hhttps://www.mysociety.org/2014/12/20/another-private-data-leak-this-time-by-hackney-council/>accidentally released in an FOI request</a>, or how likely a Sony Pictures-like scenario is. And this is the underbelly of centralisation of data. Yes, you can do big-data analysis of whatever which might help with medical research or spotting public health trends. But it’s easier to compromise a single system than all the massively heterogenous GP systems. Apparently the ONS has this in hand, so things like census data are well cared for. They tend towards the ‘Tower of London’ approach of keeping all the eggs in one basket and then guarding the basket well. Other researchers can still use the data, but there’s an ethics system in place to vet the analyses and use.</p><p>But more than this, <a href=http://theodi.org/lunchtime-lectures/friday-lunchtime-lecture-why-selling-peoples-medicaltaxschool-records-isnt-open-data>apparently</a> some are still thinking that identifiable medical records might be a revenue stream. Sort of the NHS taking on the Facebook business model. Let’s not do that.</p><p>(Originally <a href=http://web.archive.org/web/20160319092856/http://www.lshift.net/blog/2014/12/24/playing-with-open-nhs-data-and-a-rant/>http://web.archive.org/web/20160319092856/http://www.lshift.net/blog/2014/12/24/playing-with-open-nhs-data-and-a-rant/</a>)</p></section><section><footer class=page-footer><hr><div class=previous-post style=display:inline-block><a class=link-reverse href="https://uther.wtf/blog/codemesh-day-1/?ref=footer">« Codemesh Day 1</a></div><div class=next-post , style=display:inline-block;float:right><a class=link-reverse href="https://uther.wtf/blog/lets-run-science-part-iota/?ref=footer">Lets Run Science Part Iota »</a></div><ul class=page-footer-menu><li><a href=https://twitter.com/hemul><i class="fab fa-twitter fa-lg"></i></a></li><li><a href=https://github.com/jbu><i class="fab fa-github fa-lg"></i></a></li><li><a href="https://scholar.google.com/citations?user=AquEEvUAAAAJ"><i class="fas fa-graduation-cap la-lg"></i></a></li></ul><div class=copyright><p>&copy; 2022
James Uther.
All rights reserved.</p></div></footer></section></article></div></body></html>